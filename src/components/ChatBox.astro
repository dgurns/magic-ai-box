<div
  class="flex w-full flex-col items-start gap-8 rounded-3xl border-2 border-purple-600 bg-gray-50 p-8 md:w-[480px]"
>
  <div
    id="completion-wrapper"
    class="min-h-32 hidden h-auto w-full rounded-xl border border-dashed border-gray-400 bg-white p-4"
  >
    <div id="completion" class="text-left"></div>
    <div id="loading" class="htmx-indicator">Loading...</div>
  </div>

  <form
    hx-post="/completions/chat"
    hx-target="#completion"
    hx-indicator="#loading"
    class="flex w-full flex-col items-start gap-4"
  >
    <select name="model">
      <option value="mistral">Answer with Mistral</option>
      <option value="llama">Answer with Llama</option>
    </select>
    <input
      name="question"
      type="text"
      class="w-full"
      placeholder="What would you like to ask?"
      required
    />
    <button type="submit">Ask</button>
  </form>
</div>

<script>
  document.body.addEventListener("htmx:beforeSend", function (evt) {
    const completionWrapperEl = document.getElementById("completion-wrapper");
    if (completionWrapperEl) {
      completionWrapperEl.classList.remove("hidden");
      completionWrapperEl.classList.add("flex");
    }
    const completionEl = document.getElementById("completion");
    if (completionEl) {
      completionEl.innerHTML = "";
    }
    const inputEl = document.querySelector<HTMLInputElement>(
      "input[name=question]",
    );
    if (inputEl) {
      inputEl.value = "";
    }
  });
</script>
